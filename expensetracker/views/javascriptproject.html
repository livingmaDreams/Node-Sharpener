<!DOCTYPE html>
<html> 
    <head>
        <title>Expense Tracker</title>
    </head>
    <body>
      <form id="form" >
        <input type="hidden" id="id" name="id"  >
        <label for="amount">Choose Expenseamount:</label>
        <input type="text" id="amount" name="amount" min="0" required >
        <label for="description">Choose Description:</label>
        <input type="text" id="description" name="description" required >
        <label for="category">Choose a Category:</label>
        <select type="text" id="category" name="category" required>
         <option value="Food">Food</option>
         <option value="Travel">Travel</option>
         <option value="Medical">Medical</option>
         <option value="Pantry">Pantry</option>
        </select>
        <input type="submit" id="submit">
     </form> 
     <ul id="expense-List">
     </ul>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>
     <script src="javascriptproject.js"></script>
     <script>
           window.addEventListener("DOMContentLoaded",getDetails);
           function getDetails(){
            axios.get('http://localhost:3000/exptracker')
            .then((res) => {
              let data = res.data.userDetail;
              for(let i of data) 
                 listCreation(i)
             })
            .catch(err => console.log(err))
           }
           window.addEventListener('submit',details)
           function details(e){
            e.preventDefault();  
            const amount = document.getElementById("amount").value;
            const description = document.getElementById("description").value;
            const category = document.getElementById("category").value;
            const id = document.getElementById('id').value;
            const obj = {id,amount,description,category};
            axios.post('http://localhost:3000/exptracker/detail',obj)
            .then((res) => {
              listCreation(res.data.newUserDetail);
              document.getElementById("amount").value = '';
              document.getElementById("description").value = '';
              document.getElementById("category").value = '';
            }
              )
            .catch(err => console.log(err))
           }
           const expenseList= document.getElementById('expense-List');
           expenseList.addEventListener('click',updateDetail);
           function updateDetail(e){
            const parentElement = e.target.parentElement;
            e.preventDefault();
            if(e.target.classList.contains('delete-button')){
              if(confirm('Are you Sure?'))
                 {
                  const id = parentElement.id;
                 axios.delete(`http://localhost:3000/exptracker/delete/${id}`)
                 .then(() => expenseList.removeChild(parentElement))
                 .catch(err => console.log(err));
                 }
            }
            if(e.target.classList.contains('edit-button')){
               if(confirm('Are you Sure to edit?'))
               {
                const id = parentElement.id;
                 axios.get(`http://localhost:3000/exptracker/edit/${id}`)
                 .then((data) => {
                  editList(data.data.userdetail)
                  expenseList.removeChild(parentElement)
                 })
                 .catch(err => console.log(err));
               }   
              }
           }
     </script>
    </body> 
</html>